10 REM SUN GHA CALCULATOR - SHARP PC BASIC
20 PAUSE "SUN GHA CALCULATOR"
50 INPUT "YEAR (1980-2099)";Y
60 INPUT "MONTH (1-12)";M
70 INPUT "DAY (1-31)";D
80 INPUT "HOUR UT (0-23)";H
90 INPUT "MINUTE UT (0-59)";N
110 A=INT((14-M)/12)
120 YR=Y+4800-A
130 MO=M+12*A-3
140 JD=D+INT((153*MO+2)/5)+365*YR
150 JD=JD+INT(YR/4)-INT(YR/100)+INT(YR/400)-32045
160 T=(JD+(H+N/60)/24-2451545)/36525
170 L0=280.46646+36000.76983*T+0.0003032*T*T
180 L0=L0-INT(L0/360)*360
190 IF L0<0 THEN L0=L0+360
200 MA=357.52911+35999.05029*T-0.0001537*T*T
210 MA=MA-INT(MA/360)*360
220 IF MA<0 THEN MA=MA+360
230 MR=MA*0.0174532925
240 C=(1.914602-0.004817*T-0.000014*T*T)*SIN(MR)
250 C=C+(0.019993-0.000101*T)*SIN(2*MR)
260 C=C+0.000289*SIN(3*MR)
270 TL=L0+C
280 OM=125.04-1934.136*T
290 LA=TL-0.00569-0.00478*SIN(OM*0.0174532925)
300 EP=23.439291-0.0130042*T
310 EP=EP+0.00256*COS(OM*0.0174532925)
320 EPR=EP*0.0174532925
330 LAR=LA*0.0174532925
340 RA=ATN(COS(EPR)*SIN(LAR)/COS(LAR))
350 RA=RA*57.2957795
360 IF COS(LAR)<0 THEN RA=RA+180
370 IF RA<0 THEN RA=RA+360
380 GM=280.46061837+360.98564736629*(JD+(H+N/60)/24-2451545)
390 GM=GM+0.000387933*T*T-T*T*T/38710000
400 GM=GM-INT(GM/360)*360
410 IF GM<0 THEN GM=GM+360
420 GH=GM-RA
430 IF GH<0 THEN GH=GH+360
440 DECR=ATN(SIN(EPR)*SIN(LAR)/SQR(1-(SIN(EPR)*SIN(LAR))^2))
450 DEC=DECR*57.2957795
460 PRINT "DATE:";M;"/";D;"/";Y
470 PRINT "TIME:";H;":";N;" UT"
490 GD=INT(GH)
500 GMN=INT((GH-GD)*60)
510 GS=INT(((GH-GD)*60-GMN)*60)
520 PRINT "SUN GHA:";GD;"°";GMN;"'";GS;"''"
530 DD=INT(ABS(DEC))
540 DM=INT((ABS(DEC)-DD)*60)
550 DS=INT(((ABS(DEC)-DD)*60-DM)*60)
560 IF DEC<0 THEN PRINT "SUN DEC: S "; ELSE PRINT "SUN DEC: N ";
570 PRINT DD;"°";DM;"'";DS;"''"
590 INPUT "ANOTHER CALCULATION (1=YES,0=NO)";A
600 IF A=1 THEN GOTO 50
610 END